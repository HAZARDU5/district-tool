{{#ui-nag class="inline"}}
    <span class="title">
    Use the WSAD keys to move and the mouse to look. Click and grab objects in the scene.
  </span>
    <i class="close icon"></i>
{{/ui-nag}}

<a-scene stats physics vr-mode-ui="enabled: true" networked-scene="
  serverURL: https://haydenlee.io;
  app: district-tool;
  room: Aetheria;
  connectOnLoad: true;
  adapter: easyrtc;
  audio: false;
  debug: false;
">
    <a-assets>

        <!-- Mixins -->

        <a-mixin id="cube" shadow hoverable grabbable drag-droppable dynamic-body geometry="primitive: box; width: 1.1; height: 1.1; depth: 1.1" material="transparent: true; opacity: 0"></a-mixin>
        <a-mixin id="cube-hovered" material="opacity: 0.7; color: purple">
        </a-mixin>
        <a-mixin id="cube-dragover" material="opacity: 0.7; color: green"></a-mixin>
        <a-mixin id="cube-dragover-stop" material="opacity: 0.7; color: purple"></a-mixin>

        <a-mixin id="transformer" drag-droppable
                 fillable
                  material="shader:flat; wireframe: false; transparent: true; opacity: 0.2; color: pink; side: double"
                  geometry="primitive: plane; width: 1; height: 1; depth: 1" rotation="-90 0 0"></a-mixin>

        <a-mixin id="transformer-inv" drag-droppable
                 fillable
                 material="shader:flat; wireframe: false; transparent: true; opacity: 0.2; color: purple; side: double"
                 geometry="primitive: plane; width: 1; height: 1; depth: 1" rotation="-90 0 0"></a-mixin>

        <a-mixin id="transformer-opaque" drag-droppable
                 fillable
                 material="shader:flat; wireframe: false; transparent: false; opacity: 1; color: pink; side: double"
                 geometry="primitive: plane; width: 1; height: 1; depth: 1" rotation="-90 0 0"></a-mixin>

        <a-mixin id="transformer-inv-opaque" drag-droppable
                 fillable
                 material="shader:flat; wireframe: false;  transparent: false; opacity: 1; color: purple; side: double"
                 geometry="primitive: plane; width: 1; height: 1; depth: 1" rotation="-90 0 0"></a-mixin>

        <a-mixin id="transformer-inv-dragover" material="opacity: 0.1" material="color: #00ff00"></a-mixin>
        <a-mixin id="transformer-inv-dragover-stop" material="opacity: 0.2" material="color: purple"></a-mixin>
        <a-mixin id="transformer-dragover" material="opacity: 0.1" material="color: #00ff00"></a-mixin>
        <a-mixin id="transformer-dragover-stop" material="opacity: 0.2" material="color: pink"></a-mixin>

        <!-- Templates -->

        <!-- Player -->
        <script id="player-template" type="text/html">
            <a-entity></a-entity>
        </script>

        <!-- Head -->
        <script id="head-template" type="text/html">
            <a-entity class="avatar">
                <a-sphere class="head"
                          color="#5985ff"
                          scale="0.3 0.35 0.25"
                          random-color
                        ></a-sphere>
                <a-entity class="face"
                          position="0 0.05 0"
                        >
                    <a-sphere class="eye"
                              color="#efefef"
                              position="0.1 0.1 -0.2"
                              scale="0.12 0.12 0.12"
                            >
                        <a-sphere class="pupil"
                                  color="#000"
                                  position="0 0 -1"
                                  scale="0.2 0.2 0.2"
                                ></a-sphere>
                    </a-sphere>
                    <a-sphere class="eye"
                              color="#efefef"
                              position="-0.1 0.1 -0.2"
                              scale="0.12 0.12 0.12"
                            >
                        <a-sphere class="pupil"
                                  color="#000"
                                  position="0 0 -1"
                                  scale="0.2 0.2 0.2"
                                ></a-sphere>
                    </a-sphere>
                </a-entity>
            </a-entity>
        </script>

        <!-- Hand -->
        <script id="hand-template" type="text/html">
            <a-box scale="0.1 0.1 0.1"></a-box>
        </script>

        <!-- Box -->
        <script id="box-template" type="text/html">
            <a-box mixin="cube" class="cube"></a-box>
        </script>

        <!-- /Templates -->

        <img id="grid1x1-texture" src="assets/img/textures/grid.png" />

    </a-assets>
        <!-- progressive controls must have all objects the raycaster can interact with set or they will not fire events -->


            <a-entity position="0 3 0" progressive-controls="objects: .cube, .collidable, .transformer; maxLevel: point">
                <a-camera super-hands universal-controls>
                    <a-entity raycaster position="0 0 -0.5"
                              geometry="primitive: ring; radiusOuter: 0.008; radiusInner: 0.005; segmentsTheta: 32"
                              material="color: white; shader: flat"
                            ></a-entity>
                </a-camera>
                <a-entity id="rhand" class="right-controller"></a-entity>
                <a-entity id="lhand" class="left-controller"></a-entity>
            </a-entity>

    <a-entity template="src: #boxesTemplate; type: html" class="cube" mixin="cube" position="0 2 -1" scale="0.5 0.5 0.5"></a-entity>

    <a-entity template="src: #layoutTemplate; type: html" class="cube" mixin="cube" position="0 1 2" scale="0.5 0.5 0.5"></a-entity>
    <!--<a-entity template="src: #boxesTemplate" class="cube" mixin="cube" position="0 2 -0.5" material="color: red"></a-entity>
    <a-entity template="src: #boxesTemplate" class="cube" mixin="cube" position="-1 2 -1" material="color: blue"></a-entity>
    <a-entity template="src: #boxesTemplate" class="cube" mixin="cube" position="-1 2 -0.5" material="color: blue"></a-entity>
    <a-entity template="src: #boxesTemplate" class="cube" mixin="cube" position="1 2 -1" material="color: green"></a-entity>
    <a-entity template="src: #boxesTemplate" class="cube" mixin="cube" position="1 2 -0.5" material="color: green"></a-entity>-->

    {{transformer-grid rows="10" cols="10" class="transformer-grid" position="-0.5 2.01 -0.5"}}

    <a-entity id="tile-test" class="collidable" dynamic-body shadow hoverable grabbable drag-droppable position="0 2.5 -3">
        <a-box width="0.2" height="1" depth="0.2" position="0 0.5 -0.2"></a-box>
        <a-box width="0.2" height="1" depth="0.2" position="-0.2 0.5 0.2"></a-box>
        <a-box width="0.2" height="1" depth="0.2" position="0.2 0.5 0"></a-box>
        <a-box width="1" height="0.2" depth="1"></a-box>
    </a-entity>

    <a-entity id="tile-test3" class="collidable" dynamic-body shadow hoverable grabbable drag-droppable position="0 2.5 -3">
        <a-entity layout="type: box; margin: 0.5; columns:2; plane: xz" position="-0.25 0 -0.25">
            <a-entity>
                <a-box width="0.2" height="4" depth="0.2" position="0 2 0"></a-box>
            </a-entity>
            <a-entity>
                <a-box width="0.2" height="3" depth="0.2" position="0 1.5 0"></a-box>
            </a-entity>
            <a-entity>
                <a-box width="0.2" height="2" depth="0.2" position="0 1 0"></a-box>
            </a-entity>
            <a-entity>
                <a-box width="0.2" height="1" depth="0.2" position="0 0.5 0"></a-box>
            </a-entity>
        </a-entity>
        <a-box width="1" height="0.2" depth="1"></a-box>
    </a-entity>



    <!--<a-entity id="tile-test2" class="collidable" dynamic-body="shape: box" shadow hoverable grabbable drag-droppable position="0 2.5 -4">
        <a-box width="1" height="1" depth="1" material="transparent: true; opacity: 0.2">
        </a-box>
        <a-entity id="extrude-test"
                  extrude="path: m0.1,0.1 l-0.2,0 l0,-0.2 l0.2,0 l0,0.2 z; amount:1"
                  position="0 2.5 0"
                  rotation="-90 0 0"
                  material="color:blue"></a-entity>
    </a-entity>-->


    <!-- ground collider keeps objets from falling -->
    <a-box position="0 -3 0" snap-surface static-body class="collidable" color="#000000" width=100 height=10 depth=100 visible="false"></a-box>

    <a-entity position="0 2 0" environment="playArea: 1; preset: tron; shadow: true; flatShading: false; skyType: gradient; horizonColor: #00ccf4; lightPosition: 0 0.5 -0.2; fog: 0.6; ground: noise; grid: 1x1; seed: 1; gridColor: #ee75eb; dressingColor: #ee75eb" environment-ground-texture="src:#grid1x1-texture; repeat: 10.1 10.1"></a-entity>
    <a-entity position="0 0 0" star-system="radius: 100; color: #ee75eb; texture: assets/img/textures/star.svg"></a-entity>
</a-scene>